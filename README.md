# 图像生成提示词管理系统前端 V3.0

基于Gradio的图像生成提示词管理系统Web前端界面。

## 🆕 V3.0 新功能

### 1. 多图片上传支持
- **参考图片上传**：支持上传多张参考图片用于风格参考
- **输出图片上传**：支持上传最终生成的结果图片
- **图片管理优化**：在列表中显示图片数量信息

### 2. AI智能生成功能
- **智能分析**：基于上传的图片和基础提示词，AI自动生成完整描述
- **一键生成**：自动填充负面提示词、风格描述、使用场景等所有字段
- **人工审核**：生成结果支持人工审核和修改后保存
- **独立标签页**：专门的"智能生成"标签页，优化用户体验

### 3. 界面优化
- **版本标识**：更新为V3.0版本标识
- **功能提示**：首页添加新功能介绍
- **表格优化**：增加输出图和参考图数量显示列

## 主要特性

- 🎨 **提示词管理**：创建、查看、编辑、删除提示词
- 🤖 **AI智能生成**：上传图片自动生成完整提示词描述
- 📸 **多图片上传**：支持参考图和输出图分别上传
- 🏷️ **标签系统**：灵活的标签管理和标签搜索
- 🔍 **高级搜索**：多维度搜索和筛选功能
- 📊 **数据统计**：实时统计面板显示系统状态
- 🎯 **重复检测**：检查提示词是否重复
- 💻 **响应式设计**：适配各种屏幕尺寸

## 技术栈

- **框架**: Gradio 4.0+
- **语言**: Python 3.8+
- **HTTP客户端**: Requests
- **数据处理**: Pandas
- **图像处理**: PIL (Pillow)

## 项目结构

```
imgGeneratePrompts_front/
├── app.py              # 主应用程序
├── api_client.py       # API客户端封装
├── config.py          # 配置文件
├── requirements.txt   # 依赖包列表
├── .env              # 环境变量配置
├── README.md         # 项目说明文档
└── QUICKSTART.md     # 快速开始指南
```

## 界面功能模块

### 1. 仪表板
- 系统统计信息显示
- 最近提示词列表
- API连接状态检查

### 2. 提示词管理
- **智能生成**（新增）
  - 上传输出图和参考图
  - 输入基础提示词
  - AI自动生成完整描述
  - 审核并保存结果
- **创建提示词**
  - 支持多图片上传
  - 完整字段填写
  - 标签关联
- **查看提示词**
  - 列表展示
  - 多条件筛选
  - 分页浏览
- **编辑提示词**
  - 加载详情
  - 更新信息
  - 删除操作

### 3. 标签管理
- 查看所有标签
- 创建新标签
- 删除标签
- 搜索标签

### 4. 高级搜索
- 按标签搜索提示词
- 组合条件搜索

## 安装与运行

### 1. 环境要求

- Python 3.8+
- pip 包管理器

### 2. 克隆项目

```bash
git clone <repository-url>
cd imgGeneratePrompts_front
```

### 3. 创建虚拟环境（推荐）

```bash
python -m venv .venv
# Windows
.venv\Scripts\activate
# Linux/Mac
source .venv/bin/activate
```

### 4. 安装依赖

```bash
pip install -r requirements.txt
```

### 5. 配置环境变量

复制环境变量模板：
```bash
cp .env.example .env
```

编辑 `.env` 文件，配置后端API地址：
```env
API_BASE_URL=http://localhost:8080
API_PREFIX=http://localhost:8080/api/v1
GRADIO_SERVER_NAME=127.0.0.1
GRADIO_SERVER_PORT=7860
GRADIO_SHARE=False
```

### 6. 运行应用

```bash
python app.py
```

访问 `http://localhost:7860` 使用系统

## 使用指南

### 智能生成功能使用流程

1. **进入智能生成标签页**
   - 点击"提示词管理" → "智能生成"

2. **上传图片**
   - 上传输出结果图（必须）
   - 上传参考图片（可选，支持多张）

3. **输入基础信息**
   - 输入核心提示词
   - 选择使用的模型（可选）

4. **生成描述**
   - 点击"智能生成"按钮
   - 等待AI分析完成

5. **审核结果**
   - 查看生成的各项描述
   - 根据需要修改内容

6. **保存提示词**
   - 确认无误后点击"保存提示词"
   - 系统自动创建新的提示词记录

### 多图片上传使用说明

1. **创建提示词时**
   - 可上传多张参考图片
   - 可上传一张输出图片

2. **查看提示词时**
   - 列表显示图片数量信息
   - 详情页显示所有图片URL

## API接口对接

前端通过 `api_client.py` 与后端API通信，主要接口包括：

### 提示词相关
- `create_prompt()` - 创建提示词
- `upload_and_create_prompt_multi()` - 多图片上传创建（新增）
- `analyze_prompt()` - AI智能分析（新增）
- `get_prompts()` - 获取列表
- `update_prompt()` - 更新提示词
- `delete_prompt()` - 删除提示词

### 标签相关
- `create_tag()` - 创建标签
- `get_all_tags()` - 获取所有标签
- `delete_tag()` - 删除标签
- `search_tags()` - 搜索标签

## 配置说明

### 环境变量配置

| 变量名 | 描述 | 默认值 |
|--------|------|--------|
| API_BASE_URL | 后端API基础URL | http://localhost:8080 |
| API_PREFIX | API前缀路径 | http://localhost:8080/api/v1 |
| GRADIO_SERVER_NAME | Gradio服务器地址 | 127.0.0.1 |
| GRADIO_SERVER_PORT | Gradio服务器端口 | 7860 |
| GRADIO_SHARE | 是否创建公共链接 | False |
| DEFAULT_PAGE_SIZE | 默认分页大小 | 10 |

## V3.0升级指南

如果您从V2.0升级到V3.0：

1. **更新代码**
   ```bash
   git pull origin master
   ```

2. **更新依赖**
   ```bash
   pip install -r requirements.txt --upgrade
   ```

3. **清理缓存**
   ```bash
   rm -rf __pycache__/
   ```

4. **重启服务**
   ```bash
   python app.py
   ```

## 故障排除

### 常见问题

1. **无法连接到后端API**
   - 检查后端服务是否运行
   - 验证API_BASE_URL配置是否正确
   - 确认防火墙设置

2. **图片上传失败**
   - 检查文件大小限制
   - 确认文件格式支持
   - 验证上传目录权限

3. **AI生成功能无响应**
   - 确认后端AI服务配置
   - 检查网络连接
   - 查看后端日志

## 开发指南

### 添加新功能

1. 在 `app.py` 中添加新的界面组件
2. 在 `api_client.py` 中添加对应的API方法
3. 更新配置文件（如需要）
4. 测试功能完整性

### 代码规范

- 使用类型提示
- 添加函数文档字符串
- 遵循PEP 8规范
- 适当的错误处理

## 贡献指南

欢迎提交Issue和Pull Request！

## 许可证

MIT License

## 更新日志

### V3.0.0 (2024-01)
- ✨ 新增AI智能生成功能
- ✨ 支持多图片上传
- ✨ 界面优化和功能增强
- 🐛 修复已知问题
- 📝 更新文档

### V2.0.0
- 初始版本发布
- 基础CRUD功能
- 标签系统
- 搜索功能

## 联系方式

如有问题或建议，请提交Issue或联系开发团队。

---

**注意**: 确保后端服务已正确配置并运行，否则前端功能将无法正常使用。
